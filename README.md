# AI Chat Assistant for Blender - User Manual

## Table of Contents

1.  [Introduction](#1-introduction)
2.  [Core Features](#2-core-features)
3.  [Installation and Configuration](#3-installation-and-configuration)
    *   [Installing the Add-on](#installing-the-add-on)
    *   [Configuring API Keys](#configuring-api-keys)
    *   [Global Behavior Settings](#global-behavior-settings)
4.  [User Guide](#4-user-guide)
    *   [Starting a Chat](#starting-a-chat)
    *   [Chat Interface Explained](#chat-interface-explained)
    *   [Sending Messages with Screenshots](#sending-messages-with-screenshots)
    *   [Interacting with the AI](#interacting-with-the-ai)
5.  [Knowledge Base System](#5-knowledge-base-system)
    *   [Local Knowledge Base](#local-knowledge-base)
    *   [Community Knowledge Base](#community-knowledge-base)
6.  [Troubleshooting](#6-troubleshooting)

## 1. Introduction

The **AI Chat Assistant for Blender** is a powerful add-on designed to seamlessly integrate advanced AI chat capabilities into your Blender workflow. It's more than just a simple chatbot; it's an intelligent partner capable of understanding your current work context, analyzing screenshots, executing code, and helping you manage and share knowledge.

Whether you're a beginner seeking operational guidance or a seasoned user looking to automate scripting, this add-on provides immediate, intelligent assistance.

## 2. Core Features

*   **Multi-Model Support**: Configurable to use various AI services, including OpenAI (GPT-4o), Anthropic (Claude-3), Google (Gemini), DeepSeek, or a local Ollama instance.
*   **Vision Capabilities**: Can capture screenshots of the 3D Viewport, Node Editor, and more, sending them to the AI for analysis, enabling "visual" conversations.
*   **Context-Aware**: Automatically fetches the current Blender version, scene objects, render engine, and other information to provide context to the AI for more accurate answers.
*   **Expertise Mode**: Choose a specific domain (e.g., Modeling, Scripting, Rendering) to have the AI respond as an expert in that field.
*   **Code Execution**: Safely execute Python code generated by the AI with a single click, quickly automating tasks.
*   **Streaming Response**: Supports Gemini's streaming output, allowing you to see the AI's response as it's being generated, without waiting.
*   **Local Knowledge Base**: Create and manage your own library of notes and code snippets, which you can search, copy, and execute at any time.
*   **Community Sharing**: Share your local knowledge with the community or browse knowledge shared by others.
*   **Internationalization**: The interface supports multiple languages and automatically adapts to your Blender language settings.

## 3. Installation and Configuration

### Installing the Add-on

1.  Download the add-on's `.zip` file.
2.  Open Blender and go to `Edit > Preferences > Add-ons`.
3.  Click the `Install...` button and select the downloaded `.zip` file.
4.  Find "AI Chat Assistant for Blender" in the add-on list and check the box to enable it.
5.  The add-on will attempt to automatically install the required `requests` library. If successful, a pop-up will appear. Please follow the prompt to **disable and re-enable the add-on** or **restart Blender**.

### Configuring API Keys

After enabling the add-on, you need to configure the API key for your chosen AI provider.

1.  In the add-on preferences, find the `API Key Configuration` section.
2.  From the **AI Provider** dropdown menu, select the service you want to use.

#### Configuration for Different Providers:

*   **OpenAI/Compatible**
    *   `OpenAI API Key`: Enter your OpenAI API key.
    *   `OpenAI API URL`: Defaults to the official address. If you use a compatible third-party service, modify this URL.
    *   `OpenAI Model`: Defaults to `gpt-4o`, which can be changed as needed.

*   **Claude-3**
    *   `Claude API Key`: Enter your Anthropic API key.

*   **Gemini Flash**
    *   `Gemini API Key`: Enter your Google AI Studio API key.
    *   `Gemini Model`: Defaults to `gemini-1.5-flash-latest`.

*   **DeepSeek**
    *   `DeepSeek API Key`: Enter your DeepSeek API key.
    *   `DeepSeek API URL`: Defaults to the official address.
    *   `DeepSeek Model`: Defaults to `deepseek-chat`.

*   **Ollama Vision**
    *   `Ollama URL`: Enter the address of your local Ollama service, defaulting to `http://localhost:11434`.
    *   `Ollama Model`: Enter the name of a vision model you have downloaded in Ollama, such as `llava`.

> **Note**: API keys are stored in your local Blender configuration.

### Global Behavior Settings

In the preferences, you can also adjust the following global settings:

*   **Conversation History Length**: The number of recent messages the AI will reference when responding.
*   **Auto-Execute Code**: Automatically execute code included in the AI's response. **(Enable with caution!)**
*   **Show Detailed Process**: Print more debug information to the system console.
*   **Auto-Save Screenshots**: Automatically save generated screenshots to a temporary directory.

## 4. User Guide

### Starting a Chat

Once the add-on is enabled, a new tab named **AI Chat** will appear in the 3D Viewport's right-side toolbar (press `N` to show).

*   **Quick Settings**: Here you can quickly switch the AI Provider and Expertise Mode.
*   **Open AI Chat**: Click this button to open the main chat dialog.

### Chat Interface Explained

The chat window is your primary interface for interacting with the AI.

*   **Top Settings**: Quickly switch the AI model and expertise mode.
*   **Message Input**: Enter your questions here.
*   **Attachment Options**:
    *   **Attach 3D View Screenshot**: When checked, a screenshot of the current 3D Viewport will be sent with your message.
    *   **Attach Node Editor Screenshot**: When checked, a screenshot of the Node Editor will be attached.
    *   **Attach Custom Image**: When checked, you can select an image file from your computer to attach.
*   **Send Button**: Sends your message and any attachments to the AI.
*   **Conversation History**:
    *   Displays all your past conversations with the AI.
    *   Each message is prefixed with an icon indicating the role (`USER` or `AI`).
    *   Click the arrow to the left of a message to expand or collapse its content.
    *   Click the **Copy** icon at the top of a message to copy its full content.

### Interacting with the AI

When the AI's response contains specific types of content, additional action buttons will appear:

*   **Execute Code**: If the AI provides a Python code block, click this button to run it immediately in Blender.
*   **View Code**: Opens a new window to display the code content clearly.
*   **Save to Knowledge**: Saves a useful AI response to your local knowledge base.

## 5. Knowledge Base System

The Knowledge Base is another core feature of this add-on, divided into a "Local Knowledge Base" and a "Community Knowledge Base."

### Local Knowledge Base

You can manage this in the **Knowledge Base** panel under the **AI Chat** tab.

*   **Features**:
    *   **Search**: Quickly find the knowledge you've saved.
    *   **Category Management**: Create, rename, and delete knowledge categories.
    *   **Entry Management**:
        *   Create new entries (either `NOTE` for plain text or `CODE` for Python).
        *   Quickly create an entry from your clipboard.
        *   Edit entry content (opens in Blender's Text Editor).
        *   One-click to **Copy Content** or **Execute Code**.
    *   **Import/Export**: Back up or share your entire knowledge base in `.json` format.
    *   **Share to Community**: Share valuable local entries with the public community.

### Community Knowledge Base

This is an experimental feature aimed at building a public knowledge base contributed to by all users.

*   At the bottom of the Knowledge Base panel, click **Open Community Knowledge Base** to access the online repository (based on GitHub/Gitee Issues).
*   You can browse tips, code, and solutions shared by others.
*   Using the **Share to Community** button on a local knowledge entry, you can contribute your own knowledge.

## 6. Troubleshooting

*   **Add-on Fails to Enable or Function Incorrectly**:
    *   Check the System Console for error messages (on Windows, open via `Window > Toggle System Console`).
    *   This is often due to a failure in the automatic installation of the `requests` library. Follow the `pip` error messages in the console to try and install it manually within Blender's Python environment.

*   **API Communication Fails**:
    *   In the add-on preferences, confirm that you have entered the correct API key for the currently selected AI provider.
    *   Check your internet connection.
    *   If you are using a proxy or a third-party API endpoint, ensure the URL is entered correctly.

*   **Screenshot Fails**:
    *   The add-on includes multiple screenshot methods for compatibility. If all methods fail, check the system console for error logs.
    *   Ensure your Blender interface has a visible 3D Viewport or Node Editor.