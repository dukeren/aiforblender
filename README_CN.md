# AI 聊天助手 for Blender - 用户手册

## 目录

1.  [简介](#1-简介)
2.  [核心功能](#2-核心功能)
3.  [安装与配置](#3-安装与配置)
    *   [安装插件](#安装插件)
    *   [配置API密钥](#配置api密钥)
    *   [全局行为设置](#全局行为设置)
4.  [使用指南](#4-使用指南)
    *   [启动聊天](#启动聊天)
    *   [聊天界面详解](#聊天界面详解)
    *   [发送带截图的消息](#发送带截图的消息)
    *   [与AI的互动](#与ai的互动)
5.  [知识库系统](#5-知识库系统)
    *   [本地知识库](#本地知识库)
    *   [社区知识库](#社区知识库)
6.  [故障排查](#6-故障排查)

## 1. 简介

**AI 聊天助手 for Blender** 是一款功能强大的插件，旨在将先进的 AI 聊天功能无缝集成到 Blender 工作流中。它不仅仅是一个简单的聊天机器人，更是一个能够理解您当前工作场景、分析截图、执行代码，并帮助您管理和分享知识的智能伙伴。

无论您是初学者寻求操作指导，还是资深用户希望自动化脚本编写，此插件都能为您提供即时、智能的帮助。

## 2. 核心功能

*   **多模型支持**：可配置使用 OpenAI (GPT-4o)、Anthropic (Claude-3)、Google (Gemini)、DeepSeek 或本地 Ollama 等多种 AI 服务。
*   **视觉能力**：能够截取 3D 视图、节点编辑器等界面，并将其发送给 AI 进行分析，实现“看图说话”。
*   **情景感知**：自动获取当前 Blender 版本、场景对象、渲染引擎等信息，为 AI 提供上下文，让回答更精准。
*   **专家模式**：可选择特定领域（如建模、脚本、渲染），让 AI 以该领域专家的身份进行回答。
*   **代码执行**：一键安全执行 AI 生成的 Python 代码，快速实现自动化操作。
*   **流式响应**：支持 Gemini 的流式输出，无需等待，即时看到 AI 的回答过程。
*   **本地知识库**：创建和管理您自己的笔记和代码片段库，可随时搜索、复制和执行。
*   **社区共享**：将您的本地知识分享到社区，或浏览他人分享的知识。
*   **国际化**：界面支持多语言，根据您的 Blender 语言设置自动切换。

## 3. 安装与配置

### 安装插件

1.  下载插件的 `.zip` 压缩包。
2.  打开 Blender，进入 `编辑 > 偏好设置 > 插件`。
3.  点击 `安装...` 按钮，选择下载的 `.zip` 文件。
4.  在插件列表中找到 "AI Chat Assistant for Blender"，勾选启用它。
5.  插件会尝试自动安装所需的 `requests` 库。如果安装成功，会弹出提示，请根据提示**禁用再启用插件**或**重启 Blender**。

### 配置API密钥

启用插件后，您需要配置 AI 提供商的 API 密钥。

1.  在插件偏好设置中，找到 `API Key Configuration`（API 密钥配置）部分。
2.  在 **AI Provider** (AI 提供商) 下拉菜单中，选择您要使用的服务。

#### 不同提供商的配置：

*   **OpenAI/Compatible**
    *   `OpenAI API Key`：填入您的 OpenAI API 密钥。
    *   `OpenAI API URL`：默认为官方地址。如果您使用兼容的第三方服务（如国内镜像），请修改此 URL。
    *   `OpenAI Model`：默认为 `gpt-4o`，可根据需要修改。

*   **Claude-3**
    *   `Claude API Key`：填入您的 Anthropic API 密钥。

*   **Gemini Flash**
    *   `Gemini API Key`：填入您的 Google AI Studio API 密钥。
    *   `Gemini Model`：默认为 `gemini-1.5-flash-latest`。

*   **DeepSeek**
    *   `DeepSeek API Key`: 填入您的 DeepSeek API 密钥。
    *   `DeepSeek API URL`: 默认为官方地址。
    *   `DeepSeek Model`: 默认为 `deepseek-chat`。

*   **Ollama Vision**
    *   `Ollama URL`：填入您本地 Ollama 服务的地址，默认为 `http://localhost:11434`。
    *   `Ollama Model`：填入您在 Ollama 中已下载的视觉模型名称，如 `llava`。

> **注意**：API 密钥会保存在您的 Blender 本地配置中。

### 全局行为设置

在偏好设置中，您还可以调整以下全局设置：

*   **Conversation History Length** (对话历史长度)：AI 在回答时参考的最近消息数量。
*   **Auto-Execute Code** (自动执行代码)：是否在 AI 回复后自动执行其中包含的代码。**（请谨慎开启！）**
*   **Show Detailed Process** (显示详细过程)：在系统控制台打印更多调试信息。
*   **Auto-Save Screenshots** (自动保存截图)：是否将生成的截图保存在临时目录。

## 4. 使用指南

### 启动聊天

插件启用后，在 3D 视图的右侧工具栏（按 `N` 键显示）中，会出现一个名为 **AI Chat** 的新标签页。

*   **Quick Settings** (快速设置)：您可以在这里快速切换 AI 提供商和专家模式。
*   **Open AI Chat** (打开AI聊天)：点击此按钮，将弹出主聊天对话框。

### 聊天界面详解

聊天窗口是您与 AI 互动的主要场所。

*   **顶部设置**：快速切换AI模型和专家模式。
*   **消息输入框**：在这里输入您想问的问题。
*   **附件选项**：
    *   **Attach 3D View Screenshot**：勾选后，发送消息时会附带一张当前 3D 视图的截图。
    *   **Attach Node Editor Screenshot**：勾选后，会附带节点编辑器的截图。
    *   **Attach Custom Image**：勾选后，可以从您的电脑中选择一张图片作为附件。
*   **发送按钮**：将您的消息和附件发送给 AI。
*   **对话历史**：
    *   显示您与 AI 的所有对话记录。
    *   每条消息前有图标表示角色（`USER` 或 `AI`）。
    *   点击消息左侧的箭头可以展开或折叠消息内容。
    *   点击消息右上角的 **Copy** 图标可复制完整内容。

### 与AI的互动

当 AI 的回复包含特定内容时，会出现额外的操作按钮：

*   **Execute Code** (执行代码)：如果 AI 回复了 Python 代码块，点击此按钮可立即在 Blender 中执行它。
*   **View Code** (查看代码)：弹出一个新窗口，清晰地展示代码内容。
*   **Save to Knowledge** (存入知识库)：将这条有用的 AI 回答保存到您的本地知识库中。

## 5. 知识库系统

知识库是本插件的另一大核心功能，分为“本地知识库”和“社区知识库”。

### 本地知识库

您可以在 **AI Chat** 标签页下的 **Knowledge Base** (知识库) 面板中管理它。

*   **功能**：
    *   **搜索**：快速查找您保存的知识。
    *   **分类管理**：创建、重命名、删除知识分类。
    *   **条目管理**：
        *   创建新条目（`NOTE` 纯文本 或 `CODE` Python代码）。
        *   从剪贴板快速创建条目。
        *   编辑条目内容（会在 Blender 的文本编辑器中打开）。
        *   一键**复制内容**或**执行代码**。
    *   **导入/导出**：以 `.json` 格式备份或分享您的整个知识库。
    *   **分享到社区**：将您认为有价值的本地条目分享到公共社区。

### 社区知识库

这是一个实验性功能，旨在建立一个由所有用户共同贡献的公共知识库。

*   在知识库面板下方，点击 **Open Community Knowledge Base** 可以访问在线的知识库（基于 GitHub/Gitee Issues）。
*   您可以浏览他人分享的技巧、代码和解决方案。
*   通过本地知识库条目上的 **Share to Community** (分享到社区) 按钮，您可以将自己的知识贡献出去。

## 6. 故障排查

*   **插件启用失败或功能异常**：
    *   检查系统控制台（在 Windows 上，可通过 `窗口 > 切换系统控制台` 打开）的错误信息。
    *   很可能是 `requests` 库自动安装失败。请根据控制台的 `pip` 错误提示，尝试手动在 Blender 的 Python 环境中安装它。

*   **API 通信失败**：
    *   请在插件偏好设置中，确认您已为当前选择的 AI 提供商正确填写了 API 密钥。
    *   检查您的网络连接。
    *   如果您使用了代理或第三方 API 地址，请确保 URL 填写正确。

*   **截图失败**：
    *   插件内置了多种截图方法以保证兼容性。如果所有方法都失败，请检查系统控制台的错误日志。
    *   确保您的 Blender 界面布局正常，包含一个可见的 3D 视图或节点编辑器。